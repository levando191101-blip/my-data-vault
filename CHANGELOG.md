# 📋 更新日志 (Changelog)

本文档记录 My Data Vault 项目的所有重要变更。

---

## 🎯 **2025-12-13 - 用户体验优化** (Cursor AI Assistant)

### ✨ **新增功能**

#### **1. 优化文件和文件夹交互体验**
- **文件单击行为改进**
  - 可预览文件（图片/PDF/视频）：单击打开预览对话框
  - 不可预览文件：单击在新标签页打开
  - 所有文件：双击始终在新标签页打开
  - 移除混乱的自动进入选择模式

- **文件夹单击行为改进**
  - 非选择模式：单击文件夹卡片直接打开
  - 选择模式：单击文件夹卡片切换选择状态
  - 双击：始终打开文件夹
  - 移除文件夹图标和标题上的单独点击事件

#### **2. 统一界面交互模式**
- **搜索页面 (Search.tsx)**
  - 移除 MaterialCard 上的 Checkbox 遮罩层
  - 文件卡片现在响应单击打开/预览
  - 保留批量操作工具栏和右键菜单
  - 避免 Checkbox 干扰点击和右键菜单事件

- **回收站页面 (Trash.tsx)**
  - 移除 Checkbox 覆盖层和遮罩层
  - 文件卡片现在响应单击打开/预览
  - 恢复和永久删除按钮移到卡片下方
  - 按钮样式优化，hover 效果更友好
  - 避免遮罩层干扰点击和右键菜单事件

### 🚀 **性能优化**

#### **React Query 缓存策略优化**
- 调整 `staleTime` 为 2 分钟，保持数据较新
- 调整 `gcTime` 为 10 分钟，减少内存占用
- 禁用 `refetchOnWindowFocus`，避免频繁重新获取
- 禁用 `refetchOnMount`，利用缓存提升加载速度
- **预期效果**："我的资料"加载时间从 2-4 秒降至 < 1 秒

### 🐛 **Bug 修复**

#### **视频预览支持统一**
- 修复下拉菜单的视频预览条件
- 统一使用 `canPreview` 变量
- 现在所有预览入口（卡片点击、右键菜单、下拉菜单）都支持视频预览

#### **事件冲突处理**
- 添加事件冲突检测，避免触发子元素点击事件（如按钮、菜单、拖拽手柄、复选框）
- 优化右键菜单触发逻辑
- 改善文件和文件夹的拖拽体验

### 📝 **改进说明**

本次更新主要解决了以下用户反馈的问题：
1. ✅ "我的资料"界面加载延迟高（2-4秒）
2. ✅ 点击文件或文件夹自动进入选择模式，交互混乱
3. ✅ 回收站和搜索界面的文件处理模式与"我的资料"不一致
4. ✅ 下拉菜单中视频预览选项缺失

### 🎨 **设计理念**

- **一致性**：所有页面（我的资料、搜索、回收站）的文件交互体验保持一致
- **直观性**：单击执行最常用操作（打开/预览），双击执行备选操作（新标签页打开）
- **非侵入性**：移除遮罩层和覆盖层，让用户直接与文件卡片交互
- **渐进式**：每次只改一个文件，立即测试，确保稳定

### 🏆 **开发方法论**

- **小步快跑**：将大型改动拆分为 6 个独立的小改动
- **逐个测试**：每次改动后立即构建和测试
- **及时提交**：每个改动独立提交，便于回滚和追踪
- **文档先行**：详细记录每个改动的目的和影响

---

## 🎨 **2025-12-11 ~ 2025-12-12 - 界面美化与功能增强** (Antigravity + Gemini 3 Pro)

### ✨ **新增功能**

#### **1. 现代化 UI 设计**
- Glass Morphism 玻璃态效果
- 渐变色系统和悬浮动画
- 增强的阴影和光晕效果
- 现代化按钮和卡片样式

#### **2. 主题切换优化**
- 平滑的深色/浅色模式过渡
- View Transitions API 集成
- GPU 加速渲染
- 减少文字闪烁

#### **3. 批量操作增强**
- 套索选择（Lasso Selection）
- 批量移动、删除、下载
- 批量标签管理
- 批量操作工具栏

#### **4. 搜索功能增强**
- 高级搜索过滤器
- 搜索历史记录
- 文件大小、类型、日期范围过滤
- 排序选项（名称、日期、大小、类型）
- 视图模式切换（网格/列表）

#### **5. 软删除与回收站**
- 文件软删除机制
- 回收站页面
- 恢复和永久删除功能
- 自动清理过期文件（30天）

#### **6. 其他功能**
- 数据导出（CSV、JSON、文件打包下载）
- 键盘快捷键支持
- 文件分享功能
- 视频预览支持

### 🐛 **Bug 修复**
- 修复右键菜单与套索选择冲突
- 修复文件上传后图标延迟显示
- 修复数据库迁移问题

---

## 📚 **开发团队**

### **界面美化与功能增强** (2025-12-11 ~ 2025-12-12)
- **开发者**: Antigravity + Gemini 3 Pro
- **贡献**: 现代化 UI 设计、主题系统、批量操作、搜索增强、软删除、数据导出等核心功能

### **用户体验优化** (2025-12-13)
- **开发者**: Cursor AI Assistant
- **贡献**: 文件交互优化、界面统一、性能优化、事件冲突修复

---

## 📝 **版本规范**

本项目遵循以下版本管理规范：

### **提交信息格式**
- `feat:` 新功能
- `fix:` Bug 修复
- `perf:` 性能优化
- `refactor:` 代码重构
- `docs:` 文档更新
- `style:` 代码格式调整
- `test:` 测试相关
- `chore:` 构建/工具链相关

### **分支策略**
- `main`: 稳定的生产版本
- `develop`: 开发分支（如需要）
- `feature/*`: 功能分支（如需要）
- `bugfix/*`: Bug 修复分支（如需要）

---

## 🔮 **计划中的功能**

### **高优先级**
- [ ] Markdown 文件预览
- [ ] LaTeX 数学公式渲染
- [ ] 代码文件语法高亮预览
- [ ] 视频缩略图生成优化

### **中优先级**
- [ ] 文件版本控制
- [ ] 协作编辑功能
- [ ] 评论和标注
- [ ] AI 辅助标签和分类

### **低优先级**
- [ ] 移动端响应式优化
- [ ] PWA 支持
- [ ] 离线模式
- [ ] 文件加密存储

---

## 📄 **许可证**

本项目采用 MIT 许可证。详见 [LICENSE](./LICENSE) 文件。

---

**最后更新**: 2025-12-13  
**维护者**: [My Data Vault Team](https://github.com/levando191101-blip/my-data-vault)

